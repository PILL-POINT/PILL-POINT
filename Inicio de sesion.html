<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link rel="shortcut icon" href="LOGO.png" type="image/x-icon">
  <title>PILL-POINT</title>

  <!-- Estilos -->
  <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/lineicons.css" />
  <link rel="stylesheet" href="assets/css/materialdesignicons.min.css" />
  <link rel="stylesheet" href="assets/css/fullcalendar.css" />
  <link rel="stylesheet" href="assets/css/main.css" />
  <link rel="stylesheet" href="assets/css/bodyiniciodesesion.css" />
</head>
<body>

  <!-- LOGIN -->
  <div class="login-box" id="login-section">
    <h2>Iniciar sesión</h2>
    <form id="loginForm">
      <div class="user-box">
        <input type="text" id="usuario" required>
        <label for="usuario">Usuario</label>
      </div>
      <div class="user-box">
        <input type="password" id="password" required>
        <label for="password">Contraseña</label>
      </div>
      <button type="submit" class="animated-button">
        Ingresar
        <span></span><span></span><span></span><span></span>
      </button>
    </form>
    <p style="text-align: center; margin-top: 10px;">
      ¿No tienes cuenta? <a href="#" onclick="mostrarRegistro()">Registrarse</a>
    </p>
  </div>

  <!-- REGISTRO -->
  <div class="login-box" id="registro-section" style="display:none;">
    <h2>Registro</h2>
    <form id="registerForm">
      <div class="user-box">
        <input type="text" id="newUser" required>
        <label for="newUser">Usuario</label>
      </div>
      <div class="user-box">
        <input type="password" id="newPass" required>
        <label for="newPass">Contraseña</label>
      </div>
      <button type="submit" class="animated-button">
        Registrar
        <span></span><span></span><span></span><span></span>
      </button>
    </form>
    <p style="text-align: center; margin-top: 10px;">
      ¿Ya tienes cuenta? <a href="#" onclick="mostrarLogin()">Iniciar sesión</a>
    </p>
  </div>

  <script>
    // Cambiar entre login y registro
    function mostrarRegistro() {
      document.getElementById('login-section').style.display = 'none';
      document.getElementById('registro-section').style.display = 'block';
    }
    function mostrarLogin() {
      document.getElementById('registro-section').style.display = 'none';
      document.getElementById('login-section').style.display = 'block';
    }

    // Validación de usuario y contraseña
    function validarUsuario(usuario) {
      return usuario.length >= 4 && !/\s/.test(usuario);
    }
    function validarPassword(pass) {
      return pass.length >= 6 && /\d/.test(pass); // mínimo 6 caracteres y al menos un número
    }

    // Registro
    document.getElementById("registerForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const user = document.getElementById("newUser").value.trim();
      const pass = document.getElementById("newPass").value.trim();

      if (!validarUsuario(user)) {
        alert("El usuario debe tener al menos 4 caracteres y no contener espacios.");
        return;
      }
      if (!validarPassword(pass)) {
        alert("La contraseña debe tener al menos 6 caracteres e incluir al menos un número.");
        return;
      }

      const savedUser = localStorage.getItem("usuario");
      if (savedUser && savedUser.toLowerCase() === user.toLowerCase()) {
        alert("Este usuario ya está registrado. Por favor, inicia sesión.");
        mostrarLogin();
        return;
      }

      localStorage.setItem("usuario", user);
      localStorage.setItem("password", pass);
      alert("Usuario registrado exitosamente. Ahora puedes iniciar sesión.");
      mostrarLogin();
    });

    // Login
    document.getElementById("loginForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const user = document.getElementById("usuario").value.trim();
      const pass = document.getElementById("password").value.trim();

      if (!user || !pass) {
        alert("Por favor, completa todos los campos.");
        return;
      }

      const savedUser = localStorage.getItem("usuario");
      const savedPass = localStorage.getItem("password");

      if (user === savedUser && pass === savedPass) {
        localStorage.setItem("loggedIn", "true");
        window.location.href = "inicio de revision2.html";
      } else {
        alert("Usuario o contraseña incorrectos");
      }
    });
  </script>
</body>
</html>
